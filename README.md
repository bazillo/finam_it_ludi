# Прогнозирование ценовых котировок финансовых инструментов с использованием временных рядов и новостного контекста

## Постановка задачи

Разработано решение для многопериодного прогнозирования относительных изменений цен финансовых инструментов на 20 дней вперед. Целевая переменная представляет собой кумулятивную доходность:

`p_i = (close_(t+i) / close_t) - 1`, где i = 1, 2, 3, ..., 20

## Архитектура решения

### Многошаговая модель SARIMAX с экзогенными переменными

Решение основано на комбинации временных рядов и методов машинного обучения:

#### 1. Подготовка целевых переменных
- Вычисление 20 последовательных целевых переменных `r_1, r_2, ..., r_20`
- Каждая переменная представляет относительное изменение цены через i дней

#### 2. Извлечение признаков из временных рядов
- **Технические индикаторы**: 
  - Доходности (returns)
  - Волатильность (скользящее стандартное отклонение)
  - Изменения объема торгов
  - Отношение high/low
- **Лаговые признаки**: запаздывающие значения доходностей и объемов
- **Скользящие средние**: SMA-5, SMA-10, отношение цены к SMA

#### 3. Обработка новостного контекста
- **TF-IDF векторизация** текстов новостей
- **Тематическое моделирование** (Latent Dirichlet Allocation) для выделения 5 скрытых тем
- **Временная агрегация**: усреднение новостных тем за 24 часа до торговой сессии

#### 4. Модель прогнозирования
- **Отдельные SARIMAX модели** для каждого горизонта прогноза (1-20 дней)
- **Экзогенные переменные**: технические индикаторы + новостные темы
- **Параметры SARIMAX**: (1,0,1) × (0,0,0,0)

## Ключевые особенности

### Многомодельный подход
```python
# Отдельная модель для каждого горизонта
for i in range(1, horizon + 1):
    model = SARIMAX(target_col, exog=features, order=(1,0,1))
```
## Как пользовать нашим решением

1. положите файлы в data/raw/participants/
2. запустите скрипт scripts/sarimax_base_sol.py (Основное решение)
3. также можно запустить scripts/sarimax_dobro.py (Дополнительное решение)